<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Segmentador de Cuentas Morosas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f9f9f9; 
            color: #074863; 
        }
        .chevron-icon {
            transition: transform 0.3s ease;
        }
        .chevron-icon.rotate-180 { 
            transform: rotate(180deg);
        }
        .modal {
            display: flex; /* Always flex for centering */
            align-items: center;
            justify-content: center;
            position: fixed;
            z-index: 50;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal.is-open {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            position: relative;
            margin: auto; 
            padding: 20px; 
            width: 90%;
            max-width: 600px; 
            background-color: #ffffff;
            border-radius: 0.5rem; /* 8px */
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            max-height: 85vh; 
            overflow-y: auto; 
        }
        .modal-content-compact { 
            margin: auto; 
            padding: 16px; 
            max-width: 500px; 
            background-color: #ffffff;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            max-height: 85vh; 
            overflow-y: auto; 
        }
        .toast {
            display: none; 
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            transition: opacity 0.5s, visibility 0.5s;
        }
        .tooltip { position: relative; display: inline-flex; align-items: center; }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: max-content;
            max-width: 250px;
            background-color: #074863;
            color: #ffffff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 10;
            bottom: 125%; 
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.75rem;
            white-space: normal;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }
        *:focus-visible {
            outline: 2px solid #29ABE2;
            outline-offset: 2px;
        }
        .table-container::-webkit-scrollbar { width: 8px; height: 8px; }
        .table-container::-webkit-scrollbar-thumb { background-color: #c5c5c5; border-radius: 10px; }
        .table-container::-webkit-scrollbar-track { background-color: #ededed; }
        .table-container { scrollbar-width: thin; scrollbar-color: #c5c5c5 #ededed; }
        .hidden { display: none !important; }
        .segment-row.selected-row td {
            background-color: #e0f2fe; 
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        #segment-filters-panel-container {
            transition: width 0.3s ease-in-out, padding 0.3s ease-in-out;
        }
        #segment-preview-and-summary-container { 
            transition: width 0.3s ease-in-out;
        }
        #filters-panel-content-main.collapsed { 
            display: none;
        }      
    </style>
</head>
<body class="p-4 md:p-8 antialiased">

    <div id="app-container" class="space-y-8 md:flex-grow"> 

        <div id="screen-segment-list" class="space-y-6">
            <div class="flex flex-col sm:flex-row justify-between items-center gap-4 pb-4 border-b border-[#c5c5c5]"><h1 class="text-2xl font-semibold text-[#074863]">Gestión de Segmentos de Mora</h1></div>
            <div class="flex flex-wrap gap-2 mb-4 items-center">
                <button id="btn-show-create-segment" class="bg-[#009cdb] hover:bg-[#0586ba] text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm">Nuevo</button>
                <button id="action-btn-edit-selected-segment" class="bg-[#107da9] hover:bg-[#226693] text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm" disabled>Editar</button>
                <button id="action-btn-delete-selected-segment" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm" disabled>Eliminar</button>
                <span class="text-sm text-[#6e6e6e] mx-2 hidden md:inline">|</span>
                <button id="action-btn-duplicate-selected-segment" class="bg-[#107da9] hover:bg-[#226693] text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm" disabled>Copiar</button>
                <button id="action-btn-use-selected-segment" class="bg-[#0586ba] hover:bg-[#009cdb] text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm" disabled>Usar en Campaña express</button>
            </div>
            <p class="text-xs text-[#6e6e6e] mb-4">Seleccione un segmento de la tabla para activar las acciones. Doble clic en una fila para ver detalles.</p>
            <div class="bg-[#ffffff] shadow-xl rounded-lg p-4 sm:p-6">
                <div class="overflow-x-auto table-container">
                    <table class="min-w-full divide-y divide-[#ededed]">
                        <thead class="bg-[#f3f3f3]"><tr><th class="px-4 py-3 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Nombre del Segmento</th><th class="px-4 py-3 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Descripción</th><th class="px-4 py-3 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">N.º de Cuentas</th><th class="px-4 py-3 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Tipo</th><th class="px-4 py-3 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Creación</th><th class="px-4 py-3 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Modificación</th><th class="px-4 py-3 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Creado por</th></tr></thead>
                        <tbody class="bg-[#ffffff] divide-y divide-[#ededed]" id="segment-table-body">
                            <tr class="segment-row cursor-pointer hover:bg-[#f0f9ff]" data-segment-name="Mora Temprana General" data-segment-type="predefinido" data-segment-description="Clientes con 30-60 días de mora." data-segment-accounts="1234"><td class="px-4 py-3 whitespace-nowrap text-sm text-[#074863] font-medium">Mora Temprana General<span class="ml-1 tooltip"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-[#c5c5c5]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16V8M13 16a2 2 0 01-4 0M13 16a2 2 0 004 0M9 8a2 2 0 014 0M9 8a2 2 0 00-4 0" /><path d="M12 11c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1zm0-4c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1zm0 8c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1z" fill="#6e6e6e" /></svg><span class="tooltiptext">Segmento predefinido, no editable directamente ciertas acciones.</span></span></td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">Clientes con 30-60 días de mora.</td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">1,234</td><td class="px-4 py-3 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-[#96dbff] text-[#074863]">Predefinido</span></td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">01/01/2023</td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">01/01/2023</td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">Sistema</td></tr>
                            <tr class="segment-row cursor-pointer hover:bg-[#f0f9ff]" data-segment-name="VIPs Alto Riesgo Q4" data-segment-type="personalizado" data-segment-description="Clientes VIP con score >80 y mora >90 días." data-segment-accounts="87"><td class="px-4 py-3 whitespace-nowrap text-sm text-[#074863] font-medium">VIPs Alto Riesgo Q4</td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">Clientes VIP con score >80 y mora >90 días.</td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">87</td><td class="px-4 py-3 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-[#ededed] text-[#226693]">Personalizado</span></td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">15/03/2024</td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">20/05/2024</td><td class="px-4 py-3 whitespace-nowrap text-sm text-[#6e6e6e]">usuario.admin</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div> <div id="screen-segment-editor" class="hidden space-y-6">
            <div class="pb-4 border-b border-[#c5c5c5]">
                <div class="flex items-center justify-between mb-3"><div><h1 class="text-2xl font-semibold text-[#074863]" id="segment-editor-title">Crear Nuevo Segmento</h1></div></div>
                <div class="flex flex-wrap gap-2 items-center">
                    <button type="button" id="btn-update-preview-filters" class="bg-[#29ABE2] hover:bg-[#009cdb] text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm">Filtrar</button>
                    <button type="button" id="btn-clean-preview-filters" class="bg-[#c5c5c5] hover:bg-[#6e6e6e] text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm">Limpiar</button>
                    <span class="text-sm text-[#6e6e6e] mx-2 hidden md:inline">|</span>
                    <button type="button" id="btn-save-segment-only" class="bg-[#107da9] hover:bg-[#226693] text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm">Grabar segmento</button>
                    <button type="button" id="btn-use-segment-for-campaign" class="bg-[#009cdb] hover:bg-[#0586ba] text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm">Solo usar en campaña</button>
                    <button type="button" id="btn-cancel-segment-editor" class="text-[#6e6e6e] hover:text-[#074863] font-medium py-2 px-3 rounded-lg text-sm ml-auto">Volver</button>
                </div>
            </div>
            
            <div class="flex flex-col md:flex-row gap-6"> 
                <div class="w-full md:order-1 space-y-4" id="segment-preview-and-summary-container"> 
                    <div id="filters-summary-display" class="bg-[#ffffff] shadow-md rounded-lg p-3 md:p-4 text-xs text-[#226693] space-y-1">
                        <h3 class="font-medium mb-1 text-sm text-[#074863]">Filtros Aplicados:</h3>
                        <ul id="filters-summary-list" class="list-disc list-inside pl-2 space-y-0.5 max-h-32 overflow-y-auto table-container"><li>Ninguno</li></ul>
                    </div>
                    <div id="segment-preview-section" class="bg-[#ffffff] shadow-xl rounded-lg p-4 md:p-6 space-y-4">
                        <div class="flex flex-col sm:flex-row justify-between items-start gap-2">
                            <h3 class="text-sm font-semibold text-[#6e6e6e]">
                                <div id="preview-title-text" class="text-base font-semibold text-[#074863] mb-0.5">Vista Previa del Segmento</div>
                                <span id="filtered-accounts-count" class="font-bold text-[#009cdb]">0</span> cuentas coinciden
                                <span id="preview-loading-spinner" class="hidden animate-spin inline-block w-4 h-4 border-2 border-t-transparent border-[#009cdb] rounded-full ml-2"></span>
                            </h3>
                            <div class="flex items-center gap-2 mt-1 sm:mt-0 flex-shrink-0">
                                <select id="preview-sample-size" class="input-filter !py-1.5 !px-2 !text-xs"><option value="100">Mostrar 100</option><option value="200">Mostrar 200</option><option value="500">Mostrar 500</option><option value="all">Mostrar Todos</option></select>
                                <button type="button" id="btn-export-preview" class="bg-[#107da9] hover:bg-[#226693] text-white text-xs font-semibold py-1.5 px-3 rounded-md shadow-sm transition duration-150">Exportar</button>
                            </div>
                        </div>
                        <div class="overflow-x-auto table-container max-h-[calc(100vh-25rem)] md:max-h-[calc(100vh-23rem)]"> 
                            <table class="min-w-full divide-y divide-[#ededed]">
                                <thead class="bg-[#f3f3f3] sticky top-0"><tr><th class="px-4 py-2 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">ID Cuenta</th><th class="px-4 py-2 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Nombre Cliente</th><th class="px-4 py-2 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Días de Mora</th><th class="px-4 py-2 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Monto Adeudado</th><th class="px-4 py-2 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Último Contacto</th></tr></thead>
                                <tbody id="preview-table-body" class="bg-[#ffffff] divide-y divide-[#ededed]"><tr><td colspan="5" class="text-center p-4 text-[#6e6e6e]">Aplique filtros y presione 'Filtrar' para ver la previsualización.</td></tr></tbody>
                            </table>
                        </div>
                        <div id="preview-pagination" class="hidden flex justify-between items-center pt-2 text-sm text-[#6e6e6e]"><button class="hover:text-[#009cdb]">&lt; Anterior</button><span>Página <span id="preview-current-page">1</span> de <span id="preview-total-pages">1</span></span><button class="hover:text-[#009cdb]">Siguiente &gt;</button></div>
                    </div>
                </div>

                <div id="segment-filters-panel-container" class="w-full md:order-2 bg-[#ffffff] shadow-xl rounded-lg h-fit"> 
                    <div id="filters-panel-header" class="flex justify-between items-center p-3 md:p-4 border-b border-[#c5c5c5] cursor-pointer">
                        <h2 id="filters-panel-title" class="text-base md:text-lg font-semibold text-[#074863]">Panel de Filtros</h2>
                        <button type="button" id="btn-toggle-filters-panel" class="text-[#009cdb] p-1 rounded hover:bg-blue-100">
                            <svg id="chevron-icon-filters" class="w-5 h-5 transition-transform duration-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" /> 
                            </svg>
                        </button>
                    </div>
                    <form id="segment-form"> 
                        <div id="filters-panel-content-main" class="p-3 md:p-4 space-y-4 max-h-[calc(100vh-15rem)] overflow-y-auto table-container"> 
                            <div id="segment-identification-fields" class="hidden bg-[#f9f9f9] border border-[#ededed] rounded-lg p-4 space-y-3 mb-4">
                                <div><label for="segment-name" class="block text-sm font-medium text-[#226693]">Nombre del Segmento <span class="text-red-500">*</span></label><input type="text" name="segment-name" id="segment-name" class="mt-1 block w-full input-form-styles" required><p class="text-red-600 text-sm mt-1 hidden" id="error-segment-name">Este campo es obligatorio.</p></div>
                                <div><label for="segment-description" class="block text-sm font-medium text-[#226693]">Descripción del Segmento</label><textarea name="segment-description" id="segment-description" rows="2" class="mt-1 block w-full input-form-styles"></textarea></div>
                            </div>
                            
                            <div class="collapsible-container border border-[#c5c5c5] rounded-md">
                                <button type="button" class="collapsible-trigger flex justify-between items-center w-full p-3 bg-[#f6f6f6] hover:bg-[#ededed] rounded-t-md focus:outline-none"><span class="font-medium text-[#226693]">Datos Demográficos del Cliente</span><svg class="chevron-icon w-5 h-5 text-[#226693]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></button>
                                <div class="collapsible-content hidden p-4 grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-3">
                                    <div class="sm:col-span-2"><label for="filter-tipo-cartera" class="block text-sm font-medium text-[#226693]">Tipo de Cartera</label><select id="filter-tipo-cartera" class="mt-1 block w-full input-filter"><option value="">Todas</option><option value="propia">Propia</option><option value="terceros">Terceros</option></select></div>
                                    <div><label for="filter-edad-min" class="block text-sm font-medium text-[#226693]">Edad Mínima</label><input type="number" id="filter-edad-min" class="mt-1 block w-full input-filter"></div>
                                    <div><label for="filter-edad-max" class="block text-sm font-medium text-[#226693]">Edad Máxima</label><input type="number" id="filter-edad-max" class="mt-1 block w-full input-filter"></div>
                                    <div><label for="filter-genero" class="block text-sm font-medium text-[#226693]">Género</label><select id="filter-genero" class="mt-1 block w-full input-filter"><option value="">Cualquiera</option><option value="masculino">Masculino</option><option value="femenino">Femenino</option><option value="otro">Otro</option></select></div>
                                    <div><label for="filter-categoria-cliente" class="block text-sm font-medium text-[#226693]">Categoría Cliente</label><select id="filter-categoria-cliente" class="mt-1 block w-full input-filter"><option value="">Cualquiera</option><option value="vip">VIP</option><option value="estandar">Estándar</option></select></div>
                                    <div><label for="filter-pais" class="block text-sm font-medium text-[#226693]">País</label><input type="text" id="filter-pais" class="mt-1 block w-full input-filter"></div>
                                    <div><label for="filter-ciudad" class="block text-sm font-medium text-[#226693]">Ciudad</label><input type="text" id="filter-ciudad" class="mt-1 block w-full input-filter"></div>
                                </div>
                            </div>
                            <div class="collapsible-container border border-[#c5c5c5] rounded-md">
                                <button type="button" class="collapsible-trigger flex justify-between items-center w-full p-3 bg-[#f6f6f6] hover:bg-[#ededed] rounded-t-md focus:outline-none"><span class="font-medium text-[#226693]">Historial de Pagos Previos</span><svg class="chevron-icon w-5 h-5 text-[#226693]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></button>
                                <div class="collapsible-content hidden p-4 grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-3">
                                    <div class="sm:col-span-2"><label for="filter-tipo-impago" class="block text-sm font-medium text-[#226693]">Tipo de Impago</label><select id="filter-tipo-impago" class="mt-1 block w-full input-filter"><option value="">Cualquiera</option><option value="recurrente">Recurrente (+3 moras en un año)</option><option value="normal_buen_pagador">Normalmente buen pagador (1ra mora en un año)</option><option value="primera_vez_mora">Primera vez en mora</option><option value="primera_cuota">Primera cuota</option></select></div>
                                    <div><label for="filter-fecha-ultimopago-desde" class="block text-sm font-medium text-[#226693]">Fecha Últ. Pago (Desde)</label><input type="date" id="filter-fecha-ultimopago-desde" class="mt-1 block w-full input-filter"></div>
                                    <div><label for="filter-fecha-ultimopago-hasta" class="block text-sm font-medium text-[#226693]">Fecha Últ. Pago (Hasta)</label><input type="date" id="filter-fecha-ultimopago-hasta" class="mt-1 block w-full input-filter"></div>
                                    <div class="sm:col-span-2"><label for="filter-num-pagos-tardios" class="block text-sm font-medium text-[#226693]">Número de Pagos Tardíos</label><input type="number" id="filter-num-pagos-tardios" min="0" class="mt-1 block w-full input-filter"></div>
                                </div>
                            </div>
                            <div class="collapsible-container border border-[#c5c5c5] rounded-md">
                                <button type="button" class="collapsible-trigger flex justify-between items-center w-full p-3 bg-[#f6f6f6] hover:bg-[#ededed] rounded-t-md focus:outline-none"><span class="font-medium text-[#226693]">Scoring Crediticio e Indicadores</span><svg class="chevron-icon w-5 h-5 text-[#226693]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></button>
                                <div class="collapsible-content hidden p-4 grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-3">
                                    <div><label for="filter-score-min" class="block text-sm font-medium text-[#226693]">Score Mínimo (0-100)</label><input type="number" id="filter-score-min" min="0" max="100" class="mt-1 block w-full input-filter"></div>
                                    <div><label for="filter-score-max" class="block text-sm font-medium text-[#226693]">Score Máximo (0-100)</label><input type="number" id="filter-score-max" min="0" max="100" class="mt-1 block w-full input-filter"></div>
                                    <div><label for="filter-segmento-riesgo" class="block text-sm font-medium text-[#226693]">Segmento Riesgo</label><select id="filter-segmento-riesgo" class="mt-1 block w-full input-filter"><option value="">Cualquiera</option><option value="bajo">Bajo</option><option value="medio">Medio</option><option value="alto">Alto</option></select></div>
                                    <div><label for="filter-canal-contacto" class="block text-sm font-medium text-[#226693]">Canal Contacto Preferido</label><select id="filter-canal-contacto" class="mt-1 block w-full input-filter"><option value="">Cualquiera</option><option value="email">Email</option><option value="phone">Teléfono</option><option value="sms">SMS</option></select></div>
                                </div>
                            </div>
                            <h3 class="text-lg font-medium text-[#107da9] mt-6">Campos del Producto Moroso</h3>
                            <div class="collapsible-container border border-[#c5c5c5] rounded-md">
                                <button type="button" class="collapsible-trigger flex justify-between items-center w-full p-3 bg-[#f6f6f6] hover:bg-[#ededed] rounded-t-md focus:outline-none"><span class="font-medium text-[#226693]">Antigüedad de la Deuda</span><svg class="chevron-icon w-5 h-5 text-[#226693]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></button>
                                <div class="collapsible-content hidden p-4 grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-3">
                                    <div><label for="filter-dias-mora-min" class="block text-sm font-medium text-[#226693]">Días Mora Mínimos</label><input type="number" id="filter-dias-mora-min" min="0" class="mt-1 block w-full input-filter"></div>
                                    <div><label for="filter-dias-mora-max" class="block text-sm font-medium text-[#226693]">Días Mora Máximos</label><input type="number" id="filter-dias-mora-max" min="0" class="mt-1 block w-full input-filter"></div>
                                    <div class="sm:col-span-2"><label for="filter-rango-predefinido-deuda" class="block text-sm font-medium text-[#226693]">Rango Predefinido</label><select id="filter-rango-predefinido-deuda" class="mt-1 block w-full input-filter"><option value="personalizado">Personalizado</option><option value="1-30">1–30 días</option><option value="31-60">31–60 días</option><option value="61-90">61–90 días</option><option value="91-180">91–180 días</option><option value="180+">180+ días</option></select></div>
                                    <div><label for="filter-fecha-vencimiento-desde" class="block text-sm font-medium text-[#226693]">Fecha Vencimiento (Desde)</label><input type="date" id="filter-fecha-vencimiento-desde" class="mt-1 block w-full input-filter"></div>
                                    <div><label for="filter-fecha-vencimiento-hasta" class="block text-sm font-medium text-[#226693]">Fecha Vencimiento (Hasta)</label><input type="date" id="filter-fecha-vencimiento-hasta" class="mt-1 block w-full input-filter"></div>
                                </div>
                            </div>
                            <div class="collapsible-container border border-[#c5c5c5] rounded-md">
                                <button type="button" class="collapsible-trigger flex justify-between items-center w-full p-3 bg-[#f6f6f6] hover:bg-[#ededed] rounded-t-md focus:outline-none"><span class="font-medium text-[#226693]">Monto Adeudado</span><svg class="chevron-icon w-5 h-5 text-[#226693]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></button>
                                <div class="collapsible-content hidden p-4 grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-3">
                                    <div><label for="filter-monto-min" class="block text-sm font-medium text-[#226693]">Monto Mínimo (USD)</label><input type="number" id="filter-monto-min" min="0" class="mt-1 block w-full input-filter"></div>
                                    <div><label for="filter-monto-max" class="block text-sm font-medium text-[#226693]">Monto Máximo (USD)</label><input type="number" id="filter-monto-max" min="0" class="mt-1 block w-full input-filter"></div>
                                    <div class="sm:col-span-2"><label for="filter-porcentaje-balance" class="block text-sm font-medium text-[#226693]">Porcentaje del Balance Total (%)</label><input type="number" id="filter-porcentaje-balance" min="0" max="100" class="mt-1 block w-full input-filter"></div>
                                </div>
                            </div>
                            <div class="collapsible-container border border-[#c5c5c5] rounded-md">
                                <button type="button" class="collapsible-trigger flex justify-between items-center w-full p-3 bg-[#f6f6f6] hover:bg-[#ededed] rounded-t-md focus:outline-none"><span class="font-medium text-[#226693]">Producto / Servicio Asociado</span><svg class="chevron-icon w-5 h-5 text-[#226693]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></button>
                                <div class="collapsible-content hidden p-4 space-y-3">
                                    <div><label for="filter-tipo-producto" class="block text-sm font-medium text-[#226693]">Tipo de Producto</label><select id="filter-tipo-producto" class="mt-1 block w-full input-filter"><option value="">Todos</option><option value="mercancias">MERCANCÍAS</option><option value="prestamo">PRÉSTAMO</option><option value="restructura">RESTRUCTURA DE CRÉDITO</option><option value="vehiculo">PRÉSTAMO VEHÍCULO</option></select></div>
                                    <div><label for="filter-producto-nombre" class="block text-sm font-medium text-[#226693]">Producto (multi-selección)</label><select id="filter-producto-nombre" multiple class="mt-1 block w-full h-32 input-filter"><option value="micuentafinal">MI CUENTA FINAL</option><option value="micuentapersonal">MI CUENTA PERSONAL</option><option value="clubvida">CLUB VIDA</option><option value="mercancias_prod">MERCANCÍAS</option><option value="motos">MOTOS</option><option value="restructura_prod">RESTRUCTURA</option></select><p class="text-xs text-[#6e6e6e] mt-1">Mantén Ctrl/Cmd para seleccionar múltiples.</p></div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div> <div id="screen-campaign-list-creator" class="hidden space-y-6">
            <div class="pb-4 border-b border-[#c5c5c5]">
                <div class="flex items-center justify-between mb-3"><div><nav class="text-sm mb-1" aria-label="Breadcrumb"><ol class="list-none p-0 inline-flex"><li class="flex items-center"><button class="text-[#009cdb] hover:underline" id="breadcrumb-back-to-list-from-campaign">Lista de Segmentos</button><svg class="fill-current w-3 h-3 mx-3 text-[#c5c5c5]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></li><li class="flex items-center"><span class="text-[#6e6e6e]">Configurar Lista de Campaña</span></li></ol></nav><h1 class="text-2xl font-semibold text-[#074863]">Configurar Nueva Lista para Campaña de Mora Express</h1></div></div>
                <div class="flex flex-wrap gap-3 items-center justify-end">
                    <button type="button" id="btn-back-to-segment-editor-from-list" class="text-[#6e6e6e] hover:text-[#074863] font-medium py-2 px-3 rounded-lg text-sm">Volver al Editor</button>
                    <button type="button" id="btn-cancel-campaign-list" class="text-[#6e6e6e] hover:text-[#074863] font-medium py-2 px-3 rounded-lg text-sm">Cancelar</button>
                    <button type="submit" form="campaign-list-form" id="btn-save-campaign-list" class="bg-[#009cdb] hover:bg-[#0586ba] text-white font-semibold py-2 px-3 rounded-lg shadow-md text-sm">Guardar Lista</button>
                </div>
            </div>
            <div class="bg-[#ffffff] shadow-xl rounded-lg p-6">
                <div class="mb-6 flex items-center justify-between">
                    <div>
                        <h3 class="text-md font-semibold text-[#074863] mb-2">Segmento Seleccionado</h3>
                        <div id="campaign-selected-segment-container" class="bg-[#e0f2fe] border border-[#96dbff] rounded-lg p-4 flex items-center space-x-3">
                            <svg class="h-6 w-6 text-[#009cdb]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
                            <div>
                                <p id="campaign-selected-segment-name" class="text-[#074863] font-medium">Segmento Temporal</p>
                                <p id="campaign-selected-segment-accounts" class="text-xs text-[#107da9]">1,247 cuentas</p>
                            </div>
                        </div>
                    </div>
                    <button id="btn-assign-segment-name-on-list-creator" class="hidden ml-4 bg-blue-100 hover:bg-blue-200 text-[#009cdb] text-xs font-semibold py-1 px-2 rounded-md shadow-sm transition duration-150">Asignar Nombre</button>
                </div>
                <form id="campaign-list-form" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="md:col-span-2"><label for="list-description" class="block text-sm font-medium text-[#226693]">Descripción <span class="text-red-500">*</span></label><input type="text" id="list-description" name="list-description" class="mt-1 block w-full input-form-styles" required><p class="text-red-600 text-sm mt-1 hidden" id="error-list-description">Este campo es obligatorio.</p></div>
                        <div><label for="list-type" class="block text-sm font-medium text-[#226693]">Tipo <span class="text-red-500">*</span></label><select id="list-type" name="list-type" class="mt-1 block w-full input-form-styles" required><option value="">Seleccione un tipo</option><option value="lista">Lista</option><option value="lista_distribuida">Lista Distribuida</option><option value="marcador">Marcador</option><option value="portafolio">Portafolio</option></select><p class="text-red-600 text-sm mt-1 hidden" id="error-list-type">Seleccione un tipo.</p></div>
                        <div><label for="list-priority" class="block text-sm font-medium text-[#226693]">Prioridad <span class="text-red-500">*</span></label><input type="number" id="list-priority" name="list-priority" min="1" placeholder="Ej: 1, 2, 3..." class="mt-1 block w-full input-form-styles" required><p class="text-red-600 text-sm mt-1 hidden" id="error-list-priority">Ingrese una prioridad válida (número entero mayor a 0).</p></div>
                        <div class="md:col-start-1"><label for="list-queue-method" class="block text-sm font-medium text-[#226693]">Método de Cola <span class="text-red-500">*</span></label><select id="list-queue-method" name="list-queue-method" class="mt-1 block w-full input-form-styles" required><option value="">Seleccione método</option><option value="fifo">FIFO</option><option value="round_robin">Round Robin</option><option value="por_puntaje">Por Puntaje</option></select><p class="text-red-600 text-sm mt-1 hidden" id="error-list-queue">Seleccione un método de cola.</p></div>
                    </div>
                    <div class="pt-4 border-t border-[#c5c5c5]"><h3 class="text-lg font-semibold text-[#107da9] mb-3">Asociado a</h3><div id="asociados-tabs"><div class="border-b border-[#c5c5c5]"><nav class="-mb-px flex space-x-4" aria-label="Tabs"><button type="button" data-tab-target="tab-usuarios" class="tab-button whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-[#009cdb] text-[#009cdb]">Usuarios <span class="tab-count text-xs text-[#6e6e6e]">(0/15)</span></button><button type="button" data-tab-target="tab-equipos" class="tab-button whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-[#6e6e6e] hover:text-[#226693] hover:border-[#c5c5c5]">Equipos <span class="tab-count text-xs text-[#6e6e6e]">(1/5)</span></button><button type="button" data-tab-target="tab-unidad-negocio" class="tab-button whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-[#6e6e6e] hover:text-[#226693] hover:border-[#c5c5c5]">Unidad de Negocio <span class="tab-count text-xs text-[#6e6e6e]">(0/3)</span></button></nav></div><div class="py-4"><div id="tab-usuarios" class="tab-content space-y-3"><div class="flex gap-2 mb-2"><button type="button" class="btn-asociados-add bg-[#0586ba] hover:bg-[#009cdb] text-white text-xs px-2 py-1 rounded">Agregar</button><button type="button" class="btn-asociados-remove bg-red-500 hover:bg-red-600 text-white text-xs px-2 py-1 rounded" disabled>Eliminar</button></div><div class="max-h-40 overflow-y-auto table-container"><table class="min-w-full text-sm"><thead><tr class="bg-[#f3f3f3]"><th class="p-2 text-left font-medium text-[#226693]">Nombre</th><th class="p-2 text-left font-medium text-[#226693]">Email</th></tr></thead><tbody><tr><td class="p-2 border-b border-[#ededed]">Usuario Ejemplo 1</td><td class="p-2 border-b border-[#ededed]">u1@example.com</td></tr></tbody></table></div></div><div id="tab-equipos" class="tab-content hidden space-y-3"><div class="flex gap-2 mb-2"><button type="button" class="btn-asociados-add bg-[#0586ba] hover:bg-[#009cdb] text-white text-xs px-2 py-1 rounded">Agregar</button><button type="button" class="btn-asociados-remove bg-red-500 hover:bg-red-600 text-white text-xs px-2 py-1 rounded" disabled>Eliminar</button></div><div class="max-h-40 overflow-y-auto table-container"><table class="min-w-full text-sm"><thead><tr class="bg-[#f3f3f3]"><th class="p-2 text-left font-medium text-[#226693]">Nombre Equipo</th></tr></thead><tbody><tr><td class="p-2 border-b border-[#ededed]">Equipo Cobranzas Alfa</td></tr></tbody></table></div></div><div id="tab-unidad-negocio" class="tab-content hidden space-y-3"><div class="flex gap-2 mb-2"><button type="button" class="btn-asociados-add bg-[#0586ba] hover:bg-[#009cdb] text-white text-xs px-2 py-1 rounded">Agregar</button><button type="button" class="btn-asociados-remove bg-red-500 hover:bg-red-600 text-white text-xs px-2 py-1 rounded" disabled>Eliminar</button></div><div class="max-h-40 overflow-y-auto table-container"><table class="min-w-full text-sm"><thead><tr class="bg-[#f3f3f3]"><th class="p-2 text-left font-medium text-[#226693]">Nombre Unidad</th></tr></thead><tbody><tr><td class="p-2 border-b border-[#ededed]">Unidad Retail Central</td></tr></tbody></table></div></div></div></div></div>
                    <div class="pt-4 border-t border-[#c5c5c5]"><div class="flex justify-between items-center mb-3"><h3 class="text-lg font-semibold text-[#107da9]">Actividades Planificadas</h3><button type="button" id="btn-add-activity" class="bg-[#0586ba] hover:bg-[#009cdb] text-white text-sm font-semibold py-1.5 px-3 rounded-md shadow-sm transition duration-150">Agregar Actividad</button></div><div id="planned-activities-list" class="space-y-3"><p id="no-activities-message" class="text-sm text-[#6e6e6e]">No hay actividades planificadas.</p></div></div>
                </form>
            </div>
        </div> </div> <div id="modal-confirm-delete" class="modal"><div class="modal-content bg-[#ffffff] shadow-xl rounded-lg"><h3 class="text-lg font-semibold text-[#074863] mb-4">Confirmar Eliminación</h3><p class="text-sm text-[#226693] mb-6">¿Está seguro de que desea eliminar el segmento "<span id="delete-segment-name-modal"></span>"? Esta acción no se puede deshacer.</p><div class="flex justify-end gap-3"><button id="btn-cancel-delete-modal" class="text-[#6e6e6e] hover:text-[#074863] font-medium py-2 px-4 rounded-lg transition duration-150">Cancelar</button><button id="btn-confirm-delete-modal" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150">Eliminar</button></div></div></div>
    <div id="modal-view-details" class="modal"><div class="modal-content bg-[#ffffff] shadow-xl rounded-lg !max-w-3xl"><div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold text-[#074863]">Detalles del Segmento: <span id="details-segment-name-modal"></span></h3><button id="btn-close-details-modal" class="text-[#6e6e6e] hover:text-[#074863]"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button></div><div class="text-sm text-[#226693] mb-4 space-y-1"><p><strong>Descripción:</strong> <span id="details-segment-description-modal">N/A</span></p><p><strong>Filtros Aplicados (resumen):</strong></p><ul id="details-segment-filters-modal" class="list-disc list-inside ml-4 text-[#6e6e6e]"><li>Cargando filtros...</li></ul></div><h4 class="text-md font-semibold text-[#074863] mt-6 mb-2">Muestra de Cuentas (Primeras 10)</h4><div class="overflow-x-auto table-container max-h-60"><table class="min-w-full divide-y divide-[#ededed]"><thead class="bg-[#f3f3f3] sticky top-0"><tr><th class="px-3 py-2 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">ID Cuenta</th><th class="px-3 py-2 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Nombre Cliente</th><th class="px-3 py-2 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Días Mora</th><th class="px-3 py-2 text-left text-xs font-medium text-[#226693] uppercase tracking-wider">Monto</th></tr></thead><tbody id="details-accounts-sample-modal" class="bg-[#ffffff] divide-y divide-[#ededed]"><tr><td class="px-3 py-2 text-sm" colspan="4">Cargando muestra de cuentas...</td></tr></tbody></table></div></div></div>
    <div id="modal-save-segment" class="modal"><div class="modal-content bg-[#ffffff] shadow-xl rounded-lg"><h3 class="text-lg font-semibold text-[#074863] mb-4">Guardar Segmento</h3><p class="text-sm text-[#226693] mb-4">Por favor, asigne un nombre y una descripción para guardar el segmento.</p><div class="space-y-4"><div><label for="modal-save-segment-name" class="block text-sm font-medium text-[#226693]">Nombre del Segmento <span class="text-red-500">*</span></label><input type="text" name="modal-save-segment-name" id="modal-save-segment-name" class="mt-1 block w-full input-form-styles" required><p class="text-red-600 text-sm mt-1 hidden" id="error-modal-save-segment-name">Este campo es obligatorio.</p></div><div><label for="modal-save-segment-description" class="block text-sm font-medium text-[#226693]">Descripción del Segmento</label><textarea name="modal-save-segment-description" id="modal-save-segment-description" rows="3" class="mt-1 block w-full input-form-styles"></textarea></div><div><p class="block text-sm font-medium text-[#226693]">Resumen de Filtros Utilizados:</p><div id="modal-save-segment-filters-summary" class="mt-1 p-2 bg-[#f3f3f3] rounded-md text-xs text-[#6e6e6e] max-h-24 overflow-y-auto table-container">(Aquí se mostrará un resumen de los filtros aplicados)</div></div></div><div class="flex justify-end gap-3 mt-6"><button id="btn-modal-save-only-segment" class="bg-[#107da9] hover:bg-[#226693] text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150">Solo Grabar</button><button id="btn-modal-save-and-use-campaign" class="bg-[#009cdb] hover:bg-[#0586ba] text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150">Grabar y usar en campaña</button><button id="btn-modal-cancel-save-segment" class="text-[#6e6e6e] hover:text-[#074863] font-medium py-2 px-4 rounded-lg transition duration-150">Salir</button></div></div></div>
    
    <div id="modal-require-segment-name" class="modal">
        <div class="modal-content bg-[#ffffff] shadow-xl rounded-lg">
            <h3 class="text-lg font-semibold text-[#074863] mb-4">Asignar Nombre al Segmento</h3>
            <p class="text-sm text-[#226693] mb-4">Este segmento es temporal. Por favor, asígnele un nombre para guardarlo.</p>
            <div class="space-y-4">
                <div><label for="modal-require-segment-name-input" class="block text-sm font-medium text-[#226693]">Nombre del Segmento <span class="text-red-500">*</span></label><input type="text" name="modal-require-segment-name-input" id="modal-require-segment-name-input" class="mt-1 block w-full input-form-styles" required><p class="text-red-600 text-sm mt-1 hidden" id="error-modal-require-segment-name">Este campo es obligatorio.</p></div>
                <div><label for="modal-require-segment-description-input" class="block text-sm font-medium text-[#226693]">Descripción del Segmento</label><textarea name="modal-require-segment-description-input" id="modal-require-segment-description-input" rows="3" class="mt-1 block w-full input-form-styles"></textarea></div>
            </div>
            <div class="flex justify-end gap-3 mt-6">
                <button id="btn-modal-require-name-salir" class="text-[#6e6e6e] hover:text-[#074863] font-medium py-2 px-4 rounded-lg transition duration-150">Salir</button> 
                <button id="btn-modal-require-name-grabar" class="bg-[#009cdb] hover:bg-[#0586ba] text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150">Grabar</button>
            </div>
        </div>
    </div>

    <div id="modal-confirm-cancel-list-creation" class="modal">
        <div class="modal-content bg-[#ffffff] shadow-xl rounded-lg modal-content-compact">
            <h3 class="text-lg font-semibold text-red-600 mb-3">Confirmar Cancelación</h3>
            <p class="text-sm text-[#226693] mb-5">¿Está seguro que desea cancelar la creación de la lista? Los cambios no guardados se perderán.</p>
            <div class="flex justify-end gap-3">
                <button id="btn-confirm-cancel-list-no" class="text-[#6e6e6e] hover:text-[#074863] font-medium py-2 px-4 rounded-lg transition duration-150">No, Continuar</button>
                <button id="btn-confirm-cancel-list-yes" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150">Sí, Salir</button>
            </div>
        </div>
    </div>

    <div id="modal-list-saved-navigation" class="modal">
        <div class="modal-content bg-[#ffffff] shadow-xl rounded-lg modal-content-compact">
            <div class="flex justify-center mb-3">
                <svg class="h-10 w-10 text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
            <h3 class="text-lg text-center font-semibold text-[#074863] mb-1">¡Éxito!</h3>
            <p class="text-sm text-center text-[#226693] mb-5" id="list-saved-message">La lista ha sido creada y añadida a la Campaña de Mora Express.</p>
            <div class="flex flex-col sm:flex-row justify-center gap-3">
                <button id="btn-list-saved-goto-segments" class="w-full sm:w-auto bg-[#107da9] hover:bg-[#226693] text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150">Volver al Listado de Segmentos</button>
                <button id="btn-list-saved-goto-campaign" class="w-full sm:w-auto bg-[#009cdb] hover:bg-[#0586ba] text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150">Ver Campaña de Mora Express</button>
            </div>
        </div>
    </div>


    <div id="toast-notification" role="alert" class="toast max-w-sm w-full bg-[#074863] text-[#ffffff] shadow-lg rounded-lg pointer-events-auto p-4"><div class="flex items-start"><div class="flex-shrink-0"><svg class="h-6 w-6 text-[#96dbff]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></div><div class="ml-3 w-0 flex-1 pt-0.5"><p class="text-sm font-medium" id="toast-message">¡Éxito! La operación se completó correctamente.</p></div><div class="ml-4 flex-shrink-0 flex"><button id="btn-close-toast" class="inline-flex rounded-md p-1 text-[#ededed] hover:text-[#ffffff] focus:outline-none focus:ring-2 focus:ring-[#96dbff]"><span class="sr-only">Cerrar</span><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg></button></div></div></div>

    <template id="activity-card-template">
        <div class="activity-card bg-[#f6f6f6] p-0 rounded-md shadow border border-[#ededed]">
            <div class="activity-card-header flex justify-between items-center p-3 cursor-pointer hover:bg-[#ededed]">
                <h4 class="font-medium text-[#074863] activity-type-display">Tipo de Actividad</h4>
                <div class="flex items-center">
                     <button type="button" class="btn-toggle-activity-details text-[#107da9] hover:text-[#0586ba] mr-2" title="Mostrar/Ocultar Detalles">
                        <svg class="chevron-icon w-5 h-5 rotate-180" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
                    </button>
                    <button type="button" class="btn-remove-activity text-red-500 hover:text-red-700" title="Eliminar Actividad">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                    </button>
                </div>
            </div>
            <div class="activity-card-body p-3 border-t border-[#ededed] space-y-3"> 
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
                    <div><label class="block text-xs font-medium text-[#6e6e6e]">Tipo de Actividad</label><select class="activity-type w-full input-form-styles"><option value="llamada">Llamada</option><option value="sms">SMS</option><option value="email">Email</option><option value="visita">Visita</option><option value="whatsapp">Whatsapp</option></select></div>
                    <div class="activity-field-asunto hidden"><label class="block text-xs font-medium text-[#6e6e6e]">Asunto</label><input type="text" class="activity-asunto w-full input-form-styles"></div>
                    <div class="activity-field-template hidden"><label class="block text-xs font-medium text-[#6e6e6e]">Template</label><select class="activity-template w-full input-form-styles"><option value="template_bienvenida">Template Bienvenida</option><option value="template_recordatorio">Template Recordatorio Pago</option><option value="template_oferta">Template Oferta Especial</option></select></div>
                    <div class="activity-field-script hidden"><label class="block text-xs font-medium text-[#6e6e6e]">Script</label><select class="activity-script w-full input-form-styles"><option value="script_cobranza_1">Script Cobranza Inicial</option><option value="script_cobranza_2">Script Cobranza Avanzada</option></select></div>
                    <div class="activity-field-encuesta hidden"><label class="block text-xs font-medium text-[#6e6e6e]">Encuesta</label><select class="activity-encuesta w-full input-form-styles"><option value="encuesta_satisfaccion">Encuesta Satisfacción</option><option value="encuesta_producto">Encuesta Producto</option></select></div>
                    <div><label class="block text-xs font-medium text-[#6e6e6e]">Tipo de Planificación</label><select class="activity-planning-type w-full input-form-styles"><option value="inmediata">Inmediata</option><option value="fecha_especifica">Fecha específica</option><option value="post_dias_campana">Post días de campaña</option><option value="post_inicio_mora">Post inicio fecha mora</option></select></div>
                    <div class="activity-date-specific hidden"><label class="block text-xs font-medium text-[#6e6e6e]">Fecha de Inicio</label><input type="date" class="activity-start-date w-full input-form-styles"></div>
                    <div class="activity-days-after hidden"><label class="block text-xs font-medium text-[#6e6e6e]">Días Después</label><input type="number" min="0" class="activity-days-input w-full input-form-styles"></div>
                </div>
            </div>
        </div>
    </template>
</body>
<script src="index.js?v=0.00000001"></script>
</html>